You are working inside the ServicePro v3 multi-tenant SaaS repo.
This block adds two suggestion systems, fully multi-tenant safe, versioned, and AI-ready.

ğŸ¯ OVERVIEW OF WHAT TO IMPLEMENT
A. Platform-Level Suggestion Box (For ServicePro Users â†’ You / Jody)

Purpose:

Let paying tenants suggest improvements, report bugs, request features

Feed into your internal roadmap + eventually the Support AI training

Location:

Inside tenant dashboard â†’ â€œHelp & Feedback â†’ Suggest a Featureâ€

Storage:

Global table: platform_suggestions

Scoped by:

tenantId

submittedByUserId

category

status

B. Tenant-Level Suggestion Box (For YOUR tenantsâ€™ customers â†’ Them)

Purpose:

Clean Machine example:

â€œIâ€™d love a pet hair add-onâ€

â€œOffer early morning slotsâ€

Gives tenants insights into customer expectations

Feeds future customer portal AI

Location:

PUBLIC endpoint under each tenantâ€™s site:
/suggestions or /feedback (should not require login)

Storage:

Table: customer_suggestions

Scoped by:

tenantId

optional customerId

phone/email if present

ğŸ—„ï¸ 1. CREATE NEW TABLES (MIGRATIONS)
platform_suggestions

Fields:

id (uuid)

tenant_id

submitted_by_user_id

category (feature, bug, improvement, ui, other)

title

message

created_at

updated_at

status (new, reviewing, planned, completed, declined)

metadata (jsonb)

customer_suggestions

Fields:

id (uuid)

tenant_id

customer_id (nullable)

contact_phone (nullable)

contact_email (nullable)

message

created_at

metadata (jsonb)

Add the migration using the existing pattern in /server/db/migrations.

ğŸ§  2. BACKEND: ROUTES & SERVICES

Add new routes under:

Platform suggestions (auth required):

POST /api/platform/suggestions
GET /api/platform/suggestions (admin only)
PATCH /api/platform/suggestions/:id/status (admin only)

Customer suggestions (public):

POST /api/public/:tenantSlug/suggestions

All routes must:

Use wrapTenantDb

Enforce tenant scope strictly

Validate payloads

Return sanitized data

ğŸ¨ 3. FRONTEND UI COMPONENTS
A. Tenant Dashboard â†’ Suggest a Feature Modal

Create React component:

TenantSuggestionModal.tsx

Includes:

Title

Category select

Freeform text

Button: â€œSubmit Suggestionâ€

Toast success message

Auto-insert tenant branding (logo/color)

Place it under:

Dashboard â†’ Help & Feedback â†’ Suggest a Feature

B. Customer-Facing Public Suggestion Box

Route:

/suggestions or /feedback depending on tenant config.

Component:

PublicSuggestionBox.tsx

Features:

Tenant logo + theme

One input box (â€œYour suggestionâ€)

Optional contact fields

Submit â†’ animated success screen

Mobile-first layout

Looks like loyalty portal v2 (glassmorphism, gradients, framer motion)

ğŸ”Œ 4. OPTIONAL TENANT SETTING

Add to tenant_settings:

suggestions_box_enabled: boolean


Default true.

Frontend:

Shows/hides public suggestion page & dashboard widget.

ğŸ¤– 5. AI SUPPORT AGENT (PHASE 26 PREP) â€“ REQUIRED METADATA

Every suggestion (platform or customer) must attach:

source: "platform" | "customer"
tags: string[]


To train future AI:

â€œPain pointsâ€

â€œFeature requestsâ€

â€œBehavior requestsâ€

â€œMissing infoâ€

â€œConfusion triggersâ€

Store this in metadata.

ğŸ“¡ 6. INTERNAL ADMIN VIEW FOR YOU

Route:

/admin/suggestions (root tenant only)

Capabilities:

List all suggestions sorted newest â†’ oldest

Filter by tenant

Filter by status

Update status (â€œplannedâ€, â€œcompletedâ€, â€œdeclinedâ€)

Use the existing â€œRoot Admin Onlyâ€ permission guard.

ğŸ§ª 7. TESTING REQUIREMENTS
Backend:

Create suggestion

Fetch tenant-only suggestions

Public suggestion creation does NOT leak across tenants

Root admin can update status; normal tenant cannot

Frontend:

Suggestion modal validation

Submission success state

Public suggestion UI on mobile