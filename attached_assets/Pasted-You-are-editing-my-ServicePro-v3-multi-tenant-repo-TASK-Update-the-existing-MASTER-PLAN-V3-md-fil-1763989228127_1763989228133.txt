You are editing my ServicePro v3 multi-tenant repo.

TASK: Update the existing MASTER_PLAN_V3.md file **in place** to become **MASTER PLAN v3.4**, and add a new roadmap entry and section for **Phase 23 ‚Äì Free Tier Engine & Watermarked Sites**, without changing any of the other phase content.

Do NOT create any new files. Do NOT leave old versions behind. Just update this one file.

====================================================
STEP 1 ‚Äì UPDATE VERSION HEADER
====================================================

1. Open `MASTER_PLAN_V3.md` at the repo root.

2. Find the main title line at the top that currently reads something like:

   `# üåü MASTER PLAN v3.3 ‚Äì SERVICEPRO MULTI-TENANT SUPER-SYSTEM`

3. Change it to:

   `# üåü MASTER PLAN v3.4 ‚Äì SERVICEPRO MULTI-TENANT SUPER-SYSTEM`

Leave the rest of the heading structure and emojis as-is.

====================================================
STEP 2 ‚Äì UPDATE PHASE ROADMAP TABLE TO INCLUDE PHASE 23
====================================================

1. In the section where the **phase roadmap table** is defined (the one that lists phases 0‚Äì22 with statuses ‚úîÔ∏è / üü° / üìù), add a new row for Phase 23 at the bottom of the table.

2. The new row should look like this (match the existing table format exactly):

   | 23 | Free Tier Engine & Watermarked Sites | üìù |

3. Keep the other rows unchanged and keep the table sorted by phase number (0‚Äì23 in order).

====================================================
STEP 3 ‚Äì ADD NEW SECTION FOR PHASE 23
====================================================

Scroll to the bottom of the master plan where the last phase section (currently Phase 22 ‚Äì Agency Mode or equivalent) is defined.

Immediately **after** the Phase 22 section, append the following new section in the same style as the existing sections:

----------------------------------------------------------------
## 25. PHASE 23 ‚Äì FREE TIER ENGINE & WATERMARKED SITES üìù

**Goal:**  
Create a strategically powerful **Free Tier** that:

- Costs ServicePro nearly nothing to run.
- Gives real value to small service businesses.
- Makes upgrading to paid plans feel natural and inevitable.
- Never leaks paid-only costs (SMS, AI, telephony) into the Free tier.
- Uses watermarked websites and locked features to constantly showcase Pro/Elite.

This phase introduces the **Free tier mechanics**, **feature gating rules**, **UX for locked features**, and **watermarked website mode**.

---

### 25.1 Free Tier Positioning

**Plan name example:**  
- `free` or `starter_free` (internal code)
- Public label: ‚ÄúFree‚Äù, ‚ÄúStarter Free‚Äù, or similar.

**Core principles:**

- Free tier is a **serious** starting point, not a demo.
- Free tier never triggers **per-usage expenses** for us:
  - No SMS sends.
  - No AI tokens.
  - No Twilio voice/IVR usage.
- Free tier helps users:
  - Organize their customers.
  - Define their services.
  - Launch a basic, watermarked website.
  - Get comfortable inside ServicePro.
- All automation, messaging, and AI are behind paid gates.

---

### 25.2 Free Tier ‚Äì What‚Äôs Included (Zero or Near-Zero Cost Features)

These features are fully available on the Free plan because they rely mostly on database reads/writes and static hosting:

1. **CRM / Customer Database (Manual-Only)**  
   - Unlimited customers (within reason; can add soft caps later if needed).
   - Customer profiles: name, phone, email, vehicles, notes.
   - Basic tags and simple segmentation fields.
   - Manual activity logging (notes, ‚Äúhad a call‚Äù, ‚Äúcompleted job‚Äù).

2. **Manual Booking & Job Tracking (No automated comms)**  
   - Calendar view of jobs.
   - Ability to create/edit/delete bookings manually.
   - Manual status updates (scheduled / in progress / completed / cancelled).
   - Fields for price, service, and notes.
   - No automatic SMS/email reminders; all notifications remain manual or external.

3. **Industry Pack Setup (Read-Only / Manual Apply)**  
   - Choose an industry pack (detailing, lawn care, cleaning, photography, etc.).
   - Auto-seed:
     - Suggested services & add-ons.
     - Suggested durations.
     - Suggested base pricing (they can adjust).
   - Preloaded FAQs and example copy visible in the UI.
   - Free tier can use these to configure their CRM and services, but:
     - Automated agent behavior stays locked.
     - Campaigns & flows stay locked.

4. **Website Generator ‚Äì Free, Watermarked Site**  
   - Free tier gets:
     - A hosted website at a shared ServicePro domain, e.g.  
       `tenantSlug.servicepro-sites.com` or equivalent.
   - They can:
     - Pick from 1‚Äì2 starter templates.
     - Customize:
       - Business name.
       - About text.
       - Services list.
       - Hero text and CTAs.
       - Colors (within reasonable bounds).
   - Restrictions:
     - **No custom domain** on free tier.
     - **Watermark footer**: ‚ÄúPowered by ServicePro ‚Äì Upgrade to remove this‚Äù.
     - Limit advanced layout features to Pro/Elite (locked but visible).
   - Booking CTA can:
     - Either open a simple intake form.
     - Or just show a contact form (submit to email) on free tier.

5. **Business Overview Dashboard (Lite Analytics)**  
   - High-level stats from their manually entered data:
     - Total customers.
     - Total jobs logged.
     - Basic revenue sum (from job entries).
   - This is all computed from DB data; no external costs.

6. **Settings & Branding (Basic)**  
   - Business profile (name, city, contact email, etc.).
   - Basic logo upload (within reasonable file limits).
   - Color theme selection (applied to website + basic dashboard UI).
   - Watermark is still visible on Free websites and optionally in footer.

---

### 25.3 Free Tier ‚Äì What Is Explicitly Locked

The Free tier **must not** allow operations that cost us Twilio/AI money or that define the premium value of ServicePro.

These are **paid-only** (Pro/Elite/internal) features:

1. **SMS & AI Messaging**
   - Inbound and outbound SMS automation.
   - AI SMS agent responses.
   - Missed-call ‚Üí text flows.
   - SMS campaigns and broadcasts.
   - Automated appointment reminders by SMS.
   - Any OpenAI-token-consuming behavior.

2. **Voice & IVR / AI Voice**
   - IVR menus.
   - AI voice receptionist.
   - Phone call routing.
   - Twilio voice usage (except maybe basic incoming mapping available only for paid tiers).

3. **Automations & Workflows**
   - Notification flows (‚Äú2 days before‚Äù, ‚Äúday-of‚Äù, ‚Äúfollow-up‚Äù).
   - Auto-tagging or auto-status changes based on events.
   - Customer lifecycle automations.

4. **Loyalty & Referral Systems**
   - Points accrual/redemption.
   - Referral tracking.
   - VIP tiers, rewards, and promo engines.

5. **Customer Portal & Logins**
   - Customer-facing portal.
   - Customer OTP / magic-link login.
   - Customer-visible loyalty balances.
   - Self-service booking management.

6. **Advanced Website Features**
   - Custom domain connection.
   - Additional templates library.
   - Website sections generated by AI.
   - Multi-language options (if offered).
   - Upsell sections (e.g., ‚Äúmost popular packages‚Äù powered by analytics).

7. **Bulk Actions & Campaigns**
   - Bulk SMS/email sends.
   - Campaign analytics dashboards.
   - Automated drip sequences.

8. **Multi-Tenant / Agency Features**
   - Managing multiple child businesses under one account.
   - Whitelabel / agency dashboards.

All of the above features should **clearly exist in the UI**, but be marked as locked features with a consistent visual pattern.

---

### 25.4 Feature Gating Rules (Backend)

Phase 23 extends the existing `planTier` + `hasFeature` mechanism:

1. Add a new plan tier value:

   - `planTier: 'free' | 'starter' | 'pro' | 'elite' | 'internal'`

   Where:
   - `free` = new Free tier.
   - Existing tenants (including root) retain their current tiers.

2. Update `TIER_FEATURES` to include a Free tier entry:

   Example (conceptual, actual mapping lives in code):

   - `free`:
     - `canUseCrm`: true
     - `canUseManualBookings`: true
     - `canUseIndustryPackSetup`: true (manual-only)
     - `canUseWebsiteGeneratorFree`: true
     - `canUseCustomDomain`: false
     - `canUseSms`: false
     - `canUseAiSms`: false
     - `canUseVoiceIvr`: false
     - `canUseCampaigns`: false
     - `canUseLoyalty`: false
     - `canUseCustomerPortal`: false

   - `starter`/`pro`/`elite`/`internal`:
     - Keep existing or future mappings as defined in Phase 7.

3. All backend routes that trigger cost or premium behavior should:

   - Call `hasFeature(tenant, 'featureKey')`.
   - Return 403 / 404 / controlled error for Free tier if feature is disallowed.
   - Never silently allow Free tier tenants to use SMS, voice, or AI.

---

### 25.5 Locked Feature UX & Upgrade Tease

The Free tier should clearly show what‚Äôs possible, without being annoying.

1. **Locked UI Pattern**
   - For locked features, show:
     - A blurred or dimmed preview of the UI.
     - A small lock icon.
     - A caption like:  
       ‚ÄúAvailable on Pro and Elite plans ‚Äì upgrade to unlock.‚Äù
   - Clicking on the locked area opens:
     - An **Upgrade Modal** or navigates to the Pricing/Upgrade page.

2. **Examples:**
   - SMS page:
     - Show the existing layout, but with a ‚ÄúPro Only‚Äù overlay.
   - Campaigns page:
     - Show a nice empty state graphic with ‚ÄúUpgrade to run campaigns‚Äù.
   - Loyalty:
     - Show potential reward tiers as a teaser, with ‚ÄúUnlock Loyalty with Pro‚Äù.

3. **Pricing & Upgrade Handoff**
   - Clicking upgrade CTAs should:
     - Take the tenant to a Pricing/Plans page, or
     - Open a dedicated ‚ÄúUpgrade‚Äù dialog where they can choose a paid plan.
   - When Stripe integration (Phase 7B) exists:
     - The upgrade path will integrate with Stripe checkout.
   - Before Stripe:
     - Can route to a ‚ÄúContact us to upgrade‚Äù flow or manual onboarding.

---

### 25.6 Watermarked Website Mode

For Free tier websites:

1. Always include a footer watermark, e.g.:

   - ‚ÄúPowered by ServicePro ‚Äì Upgrade to remove this branding.‚Äù

2. This watermark:
   - Is rendered on all Free-tier booking/marketing pages.
   - Uses the platform brand, not the tenant brand.
   - Is removed automatically when tenant upgrades to Starter/Pro/Elite.

3. No custom domains:
   - Free tier is limited to `*.servicepro-sites.com` or similar.
   - Custom domain settings UI should:
     - Be visible but locked.
     - Show a short explanation:
       - ‚ÄúConnect your own domain on Pro or Elite plans.‚Äù

4. This acts as:
   - A marketing engine for ServicePro (organic footprint).
   - A constant upgrade nudge for tenants.

---

### 25.7 Onboarding Flow for Free Tier

The Free tier onboarding should:

1. Invite the user to:
   - Choose their industry.
   - Confirm business name and city.
   - Pick a website template & color scheme.
   - Add 3‚Äì5 core services.
   - Add a logo (optional).

2. At the end:
   - Show their new website URL.
   - Encourage them to:
     - Add their first customers.
     - Add their first manual jobs.
   - Show a **‚ÄúWhat you can unlock next‚Äù** panel with Pro/Elite features:
     - Automated texts.
     - AI assistant.
     - Loyalty & referrals.
     - Custom domain.

---

### 25.8 Interaction With Existing Phases

Phase 23 builds on:

- **Phase 7 ‚Äì Tiers & Feature Gating**:
  - Extends `planTier` and `TIER_FEATURES`.
- **Phase 8 ‚Äì Industry Packs**:
  - Uses packs as initial content for Free tier.
- **Phase 9 ‚Äì Website Generator**:
  - Introduces Free tier variant with watermark and limited features.
- **Phase 10 ‚Äì AI Setup & Support Agent**:
  - The assistant should know:
    - When a tenant is Free.
    - Which features are locked.
    - How to explain upgrades.
- **Phase 19 ‚Äì Analytics & Showcase Dashboards**:
  - Can later show Free ‚Üí Paid conversion metrics.

Status: **DESIGNED (üìù)**  
Implementation will be handled by subsequent feature/build phases that hook into billing, feature gating, and website generation.
----------------------------------------------------------------

====================================================
STEP 4 ‚Äì NO OTHER CHANGES
====================================================

Do NOT modify any other sections, content, or statuses in the master plan.

When you are done:

- The file should be named `MASTER_PLAN_V3.md`.
- The title should say `v3.4`.
- The phase table should list phases 0‚Äì23.
- A full Phase 23 section should be present at the end, exactly as above.